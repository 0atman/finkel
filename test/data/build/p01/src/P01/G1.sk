(module P01.G1)

(import SK.Core)

(define-macro defmacro (form)
  (case form
    ((List [name arg body])
     (case arg
       ((List list-args)
        (return `(define-macro ,name (form)
                   (case form
                     ((List ,list-args) (return ,body))
                     (_ (failS (++ (show ',name) ": error")))))))
       ((Atom (ASymbol _))
        (return `(define-macro ,name (,arg)
                   (return ,body))))))
    (_ (failS "defmacro: error"))))
